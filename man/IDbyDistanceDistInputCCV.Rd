% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SpatialProvDistInput_function.R
\name{IDbyDistanceDistInputCCV}
\alias{IDbyDistanceDistInputCCV}
\title{Spatial Provenancing Correct Cross-Validation calculation from distance data}
\usage{
IDbyDistanceDistInputCCV(
  LatLongs,
  DistDataMat,
  Verbose = TRUE,
  PrintProg = TRUE,
  ProvConfidence = 0.95,
  Method = c("Pearson", "Spearman")
)
}
\arguments{
\item{LatLongs}{a matrix of n rows by 2 columns where n is the number of reference specimens in your dataset and the columns are Latitude and Longitude values in that order. These latitude-longitude coordinates should be of the locations of the reference specimens.}

\item{DistDataMat}{is a square matrix of pairwise distances among all reference specimens}

\item{Verbose}{logical whether or not a matrix of spatial correlation values is returned or not. Default is set to TRUE.}

\item{PrintProg}{logical whether or not to print a progress bar. Default set to FALSE.}

\item{ProvConfidence}{is a value between 0 and 1 indicating the confidence level that is desired for spatial provenancing.}

\item{Method}{determines what kind of correlation coefficient should be used, either "Spearman" or "Pearson". Spearman's ranked correlation coefficient does not assume a linear relationship between geographic and trait distances, whereas Pearson's coefficient does.}
}
\value{
If Verbose is set to FALSE then a list of a single object containing the correlation value at the required confidence interval is returned. If Verbose is set to TRUE then a list is returned with two objects: the first is the correlation value at the required confidence interval; the second a dataframe of coordinates and the spatial-trait correlation values at the true locations of each specimen.
}
\description{
This function takes pairwise distances among all reference specimens with known spatial origins
and uses those distances to calculate the correllation value that would be required to
correctly provenancing them in a test. This is achieved by a leave-one-out procedure. If a
cross-validation procedure that removes more than one specimen from the reference dataset is
desired then it is recommended that the validate function of the IDbyDistanceDistInput method be used
with the validate argument in a loop.
}
\details{
This method also makes use of the \code{\link[stats]{cor.test}} function from the \code{stats} package. When the \code{PrintProg} is set to TRUE, the \code{\link[svMisc]{progress}} function of the \code{svMisc} package is used.
The map plotting of this function makes use of the functions of the \code{maps} package.
}
\section{Citations}{


Original S code by Richard A. Becker, Allan R. Wilks. R version by Ray Brownrigg.
Enhancements by Thomas P Minka and Alex Deckmyn. (2017). maps: Draw Geographical Maps. R
package version 3.2.0. https://CRAN.R-project.org/package=maps

Grosjean, Ph. (2016). svMisc: SciViews-R. UMONS, Mons, Belgium.
http://www.sciviews.org/SciViews-R.
}

\author{
Ardern Hulme-Beaman

RatDistMat <- ProcDistanceTable(Rpraetor$LMs)

Range.Exp <- .5

Long.Range <- c(floor(min(Rpraetor$Lat.Long$Long))
              -Range.Exp,ceiling(max(Rpraetor$Lat.Long$Long)+Range.Exp))

Lat.Range <- c(floor(min(Rpraetor$Lat.Long$Lat))
              -Range.Exp,ceiling(max(Rpraetor$Lat.Long$Lat)+Range.Exp))

rThres <- IDbyDistanceDistInputCCV(LatLongs = Rpraetor$Lat.Long,
              DistDataMat = RatDistMat,
              Verbose = TRUE,
              ProvConfidence = .95,
              PrintProg = FALSE)
}
